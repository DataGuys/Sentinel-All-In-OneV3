{
    "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
    "handler": "Microsoft.Azure.CreateUIDef",
    "version": "0.1.2-preview",
    "parameters": {
        "config": {
            "isWizard": false,
            "basics": {
                "description": "**Microsoft Sentinel All-In-One V3** - Cost Optimized Deployment. This template deploys a full Sentinel environment with advanced cost control features, including multi-tier storage, optimized data collection, and cost monitoring dashboards.",
                "location": {
                    "label": "Location",
                    "toolTip": "Location for all resources",
                    "resourceTypes": [
                        "Microsoft.OperationalInsights/workspaces"
                    ]
                }
            }
        },
        "basics": [
            {
                "name": "rgName",
                "type": "Microsoft.Common.TextBox",
                "label": "Resource Group name",
                "placeholder": "",
                "defaultValue": "",
                "toolTip": "Enter a resource group name",
                "constraints": {
                    "required": true,
                    "regex": "^[A-Za-z0-9][A-Za-z0-9-]+[A-Za-z0-9]$",
                    "validationMessage": "Only alphanumeric characters are allowed, and the value must be 1-30 characters long."
                },
                "visible": true  
            },
            {
                "name": "workspaceName",
                "type": "Microsoft.Common.TextBox",
                "label": "Workspace Name",
                "placeholder": "",
                "defaultValue": "",
                "toolTip": "The Workspace name should include 4-63 letters, digits or '-'. The '-' shouldn't be the first or the last symbol.",
                "constraints": {
                    "required": true,
                    "regex": "^[A-Za-z0-9][A-Za-z0-9-]+[A-Za-z0-9]$",
                    "validationMessage": "Only alphanumeric characters are allowed, and the value must be 1-30 characters long."
                },
                "visible": true
            },
            {
                "name": "dailyQuota",
                "type": "Microsoft.Common.TextBox",
                "label": "Daily ingestion limit in GBs. Enter 0 for no limit.",
                "placeholder": "",
                "defaultValue": "0",
                "toolTip": "This limit doesn't apply to the following tables: SecurityAlert, SecurityBaseline, SecurityBaselineSummary, SecurityDetection, SecurityEvent, WindowsFirewall, MaliciousIPCommunication, LinuxAuditLog, SysmonEvent, ProtectionStatus, WindowsEvent. [Learn more](https://learn.microsoft.com/azure/azure-monitor/logs/daily-cap)",
                "constraints": {
                    "required": true,
                    "regex": "^[0-9]{1,4}$",
                    "validationMessage": "Only numbers allowed, and the value must be 1-4 characters long."
                },
                "visible": true
            },
            {
                "name": "pricingTier",
                "type": "Microsoft.Common.DropDown",
                "label": "Select pricing tier for Sentinel and Log Analytics",
                "placeholder": "",
                "multiselect": false,
                "toolTip": "Visit [Azure Monitor Pricing page](https://azure.microsoft.com/pricing/details/monitor/) for more information.",
                "defaultValue": [{"value": "PerGB2018"}],
                "constraints": {
                    "allowedValues": [
                        {
                            "label": "Pay-as-you-go",
                            "value": "PerGB2018"
                        },
                        {
                            "label": "Commitment Tier",
                            "value": "CapacityReservation"
                        }
                    ],
                    "required": true
                },
                "visible": true
            },
            {
                "name": "capacityReservation",
                "type": "Microsoft.Common.DropDown",
                "label": "Select Commitment Tier for Sentinel and Log Analytics",
                "placeholder": "",
                "multiselect": false,
                "defaultValue": 100,
                "toolTip": "Select the Commitment Tier in GB/day",
                "constraints": {
                    "allowedValues": [
                        {
                            "label": "100 GB",
                            "value": 100
                        },
                        {
                            "label": "200 GB",
                            "value": 200
                        },
                        {
                            "label": "300 GB",
                            "value": 300
                        },
                        {
                            "label": "400 GB",
                            "value": 400
                        },
                        {
                            "label": "500 GB",
                            "value": 500
                        },
                        {
                            "label": "1000 GB",
                            "value": 1000
                        },
                        {
                            "label": "2000 GB",
                            "value": 2000
                        },
                        {
                            "label": "5000 GB",
                            "value": 5000
                        }
                    ],
                    "required": true
                },
                "visible": "[if(equals(basics('pricingTier'),'CapacityReservation'), true, false)]"
            }
        ],
        "steps": [
            {
                "name": "storageConfig",
                "label": "Storage Tier Configuration",
                "elements": [
                    {
                        "name": "infoBoxStorageTiers",
                        "type": "Microsoft.Common.InfoBox",
                        "visible": true,
                        "options": {
                            "icon": "Info",
                            "text": "Sentinel V3 enables multi-tier storage to optimize costs. Standard tier is for active security analysis, Auxiliary tier for less critical data, and Basic tier for long-term compliance data at lower cost.",
                            "uri": "https://learn.microsoft.com/azure/azure-monitor/logs/data-retention-archive"
                        }
                    },
                    {
                        "name": "enableMultiTier",
                        "type": "Microsoft.Common.CheckBox",
                        "label": "Enable multi-tier storage",
                        "toolTip": "This enables cost-optimized multi-tier storage capabilities",
                        "defaultValue": true
                    },
                    {
                        "name": "standardTierRetention",
                        "type": "Microsoft.Common.Slider",
                        "label": "Standard Tier Retention (days)",
                        "min": 30,
                        "max": 730,
                        "defaultValue": 90,
                        "showStepMarkers": false,
                        "toolTip": "Retention period for critical security data in the Standard tier",
                        "constraints": {
                            "required": true
                        },
                        "visible": true
                    },
                    {
                        "name": "auxiliaryTierRetention",
                        "type": "Microsoft.Common.Slider",
                        "label": "Auxiliary Tier Retention (days)",
                        "min": 7,
                        "max": 730,
                        "defaultValue": 30,
                        "showStepMarkers": false,
                        "toolTip": "Retention period for less frequently accessed logs in the Auxiliary tier",
                        "constraints": {
                            "required": true
                        },
                        "visible": "[steps('storageConfig').enableMultiTier]"
                    },
                    {
                        "name": "basicTierRetention",
                        "type": "Microsoft.Common.Slider",
                        "label": "Basic Tier Retention (days)",
                        "min": 7,
                        "max": 2555,
                        "defaultValue": 180,
                        "showStepMarkers": false,
                        "toolTip": "Retention period for compliance and archive data in the Basic tier at lower cost",
                        "constraints": {
                            "required": true
                        },
                        "visible": "[steps('storageConfig').enableMultiTier]"
                    }
                ]
            },
            {
                "name": "costOptimization",
                "label": "Cost Optimization",
                "elements": [
                    {
                        "name": "infoBoxCostOptimization",
                        "type": "Microsoft.Common.InfoBox",
                        "visible": true,
                        "options": {
                            "icon": "Info",
                            "text": "Configure data collection settings to optimize costs for high-volume data sources like Entra ID and Corelight."
                        }
                    },
                    {
                        "name": "enableCostDashboard",
                        "type": "Microsoft.Common.CheckBox",
                        "label": "Deploy cost monitoring dashboard",
                        "toolTip": "Deploy a specialized workbook for monitoring and optimizing Sentinel costs",
                        "defaultValue": true
                    },
                    {
                        "name": "entraIDSection",
                        "type": "Microsoft.Common.Section",
                        "label": "Entra ID Optimization",
                        "elements": [
                            {
                                "name": "entraIDTier",
                                "type": "Microsoft.Common.DropDown",
                                "label": "Storage tier for Entra ID logs",
                                "placeholder": "",
                                "defaultValue": "Auxiliary",
                                "toolTip": "Select appropriate storage tier for Entra ID logs",
                                "constraints": {
                                    "allowedValues": [
                                        {
                                            "label": "Standard",
                                            "value": "Standard"
                                        },
                                        {
                                            "label": "Auxiliary",
                                            "value": "Auxiliary"
                                        },
                                        {
                                            "label": "Basic",
                                            "value": "Basic"
                                        }
                                    ],
                                    "required": true
                                },
                                "visible": "[steps('storageConfig').enableMultiTier]"
                            },
                            {
                                "name": "nonInteractiveSignInsEnabled",
                                "type": "Microsoft.Common.CheckBox",
                                "label": "Collect Non-Interactive Sign-in logs",
                                "toolTip": "Non-Interactive sign-ins are high volume but often less security-critical. You can enable them and store in cost-optimized tiers.",
                                "defaultValue": true
                            }
                        ],
                        "visible": true
                    },
                    {
                        "name": "corelightSection",
                        "type": "Microsoft.Common.Section",
                        "label": "Corelight Optimization",
                        "elements": [
                            {
                                "name": "enableCorelight",
                                "type": "Microsoft.Common.CheckBox",
                                "label": "Enable Corelight data collection",
                                "toolTip": "Set up cost-optimized Corelight data collection",
                                "defaultValue": false
                            },
                            {
                                "name": "highValueTableTier",
                                "type": "Microsoft.Common.DropDown",
                                "label": "Tier for high-value tables (DNS, HTTP, SSL)",
                                "placeholder": "",
                                "defaultValue": "Standard",
                                "toolTip": "Select storage tier for high security value Corelight tables",
                                "constraints": {
                                    "allowedValues": [
                                        {
                                            "label": "Standard",
                                            "value": "Standard"
                                        },
                                        {
                                            "label": "Auxiliary",
                                            "value": "Auxiliary"
                                        },
                                        {
                                            "label": "Basic",
                                            "value": "Basic"
                                        }
                                    ],
                                    "required": true
                                },
                                "visible": "[and(steps('costOptimization').corelightSection.enableCorelight, steps('storageConfig').enableMultiTier)]"
                            },
                            {
                                "name": "mediumValueTableTier",
                                "type": "Microsoft.Common.DropDown",
                                "label": "Tier for medium-value Corelight tables",
                                "placeholder": "",
                                "defaultValue": "Auxiliary",
                                "toolTip": "Select storage tier for medium security value Corelight tables",
                                "constraints": {
                                    "allowedValues": [
                                        {
                                            "label": "Standard",
                                            "value": "Standard"
                                        },
                                        {
                                            "label": "Auxiliary",
                                            "value": "Auxiliary"
                                        },
                                        {
                                            "label": "Basic",
                                            "value": "Basic"
                                        }
                                    ],
                                    "required": true
                                },
                                "visible": "[and(steps('costOptimization').corelightSection.enableCorelight, steps('storageConfig').enableMultiTier)]"
                            },
                            {
                                "name": "lowValueTableTier",
                                "type": "Microsoft.Common.DropDown",
                                "label": "Tier for low-value Corelight tables",
                                "placeholder": "",
                                "defaultValue": "Basic",
                                "toolTip": "Select storage tier for lower security value Corelight tables",
                                "constraints": {
                                    "allowedValues": [
                                        {
                                            "label": "Standard",
                                            "value": "Standard"
                                        },
                                        {
                                            "label": "Auxiliary",
                                            "value": "Auxiliary"
                                        },
                                        {
                                            "label": "Basic",
                                            "value": "Basic"
                                        }
                                    ],
                                    "required": true
                                },
                                "visible": "[and(steps('costOptimization').corelightSection.enableCorelight, steps('storageConfig').enableMultiTier)]"
                            }
                        ],
                        "visible": true
                    }
                ]
            },
            {
                "name": "industrySpecific",
                "label": "Industry Configuration",
                "elements": [
                    {
                        "name": "infoBoxIndustry",
                        "type": "Microsoft.Common.InfoBox",
                        "visible": true,
                        "options": {
                            "icon": "Info",
                            "text": "Configure industry-specific settings and deploy specialized content for your vertical."
                        }
                    },
                    {
                        "name": "industryVertical",
                        "type": "Microsoft.Common.DropDown",
                        "label": "Select your industry vertical",
                        "placeholder": "",
                        "defaultValue": "General",
                        "toolTip": "We will deploy specialized queries and configurations optimized for your industry",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Healthcare",
                                    "value": "Healthcare"
                                },
                                {
                                    "label": "Financial Services",
                                    "value": "Financial"
                                },
                                {
                                    "label": "Government",
                                    "value": "Government"
                                },
                                {
                                    "label": "Manufacturing",
                                    "value": "Manufacturing"
                                },
                                {
                                    "label": "Retail",
                                    "value": "Retail"
                                },
                                {
                                    "label": "Technology",
                                    "value": "Technology"
                                },
                                {
                                    "label": "General (not industry-specific)",
                                    "value": "General"
                                }
                            ],
                            "required": true
                        },
                        "visible": true
                    }
                ]
            },
            {
                "name": "settings",
                "label": "Sentinel Settings",
                "elements": [
                    {
                        "name": "infoBoxSettings",
                        "type": "Microsoft.Common.InfoBox",
                        "visible": true,
                        "options": {
                            "icon": "Info",
                            "text": "Please select which settings you would like to enable in your Microsoft Sentinel environment"
                        }
                    },
                    {
                        "name": "enableUeba",
                        "type": "Microsoft.Common.CheckBox",
                        "label": "Enable User Entity Behavior Analytics (UEBA)? Global Admin or Security Admin permission required.",
                        "toolTip": "This will only enable synchronization with identity providers. Data sources need to be enabled separately. [Learn more](https://learn.microsoft.com/azure/sentinel/identify-threats-with-entity-behavior-analytics)",
                        "constraints": {
                            "required": false,
                            "validationMessage": "Please choose"
                        }
                    },
                    {
                        "name": "identityProviders",
                        "type": "Microsoft.Common.DropDown",
                        "label": "Select which Identity Providers will be synchronized with UEBA",
                        "placeholder": "Choose identity provider",
                        "multiselect": true,
                        "toolTip": "Select the identity providers that you would like to enable for UEBA",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Microsoft Entra ID",
                                    "value": "AzureActiveDirectory"
                                },
                                {
                                    "label": "Active Directory (requires Microsoft Defender for Identity)",
                                    "value": "ActiveDirectory"
                                }
                            ],
                            "required": false
                        },
                        "visible": "[steps('settings').enableUeba]"
                    },
                    {
                        "name": "enableDiagnostics",
                        "type": "Microsoft.Common.CheckBox",
                        "label": "Enable Sentinel health diagnostics?",
                        "toolTip": "This will enable diagnostics settings for Analytics rules, Data Connectors and Automation rules. [Learn more](https://learn.microsoft.com/azure/sentinel/health-audit)",
                        "constraints": {
                            "required": false,
                            "validationMessage": "Please select"
                        },
                        "visible": true
                    }
                ]
            },
            {
                "name": "solutions",
                "label": "Content Hub Solutions",
                "elements": [
                    {
                        "name": "infoBox1",
                        "type": "Microsoft.Common.InfoBox",
                        "visible": true,
                        "options": {
                            "icon": "Info",
                            "text": "Please select which Solutions you want to install into your Microsoft Sentinel environment. Solutions may contain different content types, like data connectors, analytics rules, parsers, workbooks, playbooks, hunting queries, etc.",
                            "uri": "https://learn.microsoft.com/azure/sentinel/sentinel-solutions-catalog"
                        }
                    },
                    {
                        "name": "enableSolutions1P",
                        "type": "Microsoft.Common.DropDown",
                        "label": "Select Microsoft Content Hub solutions to install",
                        "placeholder": "",
                        "multiselect": true,
                        "filter": true,
                        "filterPlaceholder": "Filter items ...",
                        "multiLine": true,
                        "defaultDescription": "A value for selection",
                        "toolTip": "Select the Microsoft solutions that you would like to install",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Microsoft Entra ID",
                                    "description": "The Microsoft Entra ID solution for Microsoft Sentinel enables you to ingest Azure Active Directory Audit,Sign-in,Provisioning,Risk Events and Risky User/Service Principal logs using Diagnostic Settings into Microsoft Sentinel.",
                                    "value": "Microsoft Entra ID"
                                },
                                {
                                    "label": "Azure Activity",
                                    "description": "The Azure Activity solution for Microsoft Sentinel enables you to ingest Azure Activity Administrative, Security, Service Health, Alert, Recommendation, Policy, Autoscale and Resource Health logs using Diagnostic Settings into Microsoft Sentinel.",
                                    "value": "Azure Activity"
                                },
                                {
                                    "label": "Microsoft 365",
                                    "description": "The Microsoft 365 solution for Microsoft Sentinel enables you to ingest operational logs from Microsoft 365 to gain insights into user and admin activity across your collaboration platforms such as Teams, SharePoint and Exchange.",
                                    "value": "Microsoft 365"
                                },
                                {
                                    "label": "Microsoft Defender for Cloud",
                                    "description": "The Microsoft Defender for Cloud solution for Microsoft Sentinel allows you to ingest Security alerts reported in Microsoft Defender for Cloud on assessing your hybrid cloud workload's security posture.",
                                    "value": "Microsoft Defender for Cloud"
                                },
                                {
                                    "label": "Microsoft Defender for Endpoint",
                                    "description": "Microsoft Defender for Endpoint is an enterprise endpoint security platform designed to help enterprise networks prevent, detect, investigate, and respond to advanced threats.",
                                    "value": "Microsoft Defender for Endpoint"
                                },
                                {
                                    "label": "Threat Intelligence",
                                    "description": "Ingest threat indicators into Microsoft Sentinel. Threat indicators can be IP addresses, domains, URLs and file hashes and can be used to correlate across log sources for known indicators of compromise and/or indicators of active attack",
                                    "value": "Threat Intelligence"
                                }
                            ],
                            "required": false
                        },
                        "visible": true
                    },
                    {
                        "name": "enableSolutionsEssentials",
                        "type": "Microsoft.Common.DropDown",
                        "label": "Select Essentials Content Hub solutions to install",
                        "placeholder": "",
                        "multiselect": true,
                        "filter": true,
                        "filterPlaceholder": "Filter items ...",
                        "multiLine": true,
                        "defaultDescription": "A value for selection",
                        "toolTip": "Select essentials solutions that you would like to install",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Cloud Identity Threat Protection Essentials",
                                    "description": "The Cloud Identity Threat Protection Essentials solution looks for most common cloud focused identity attacks such as Suspicious Sign-ins, privilege grants, MFA disable etc.",
                                    "value": "Cloud Identity Threat Protection Essentials"
                                },
                                {
                                    "label": "Cloud Service Threat Protection Essentials",
                                    "description": "The Cloud Service Threat Protection Essentials contains security content that is relevant for detection of attacks against various cloud services like key vault, storage, compute etc.",
                                    "value": "Cloud Service Threat Protection Essentials"
                                },
                                {
                                    "label": "Endpoint Threat Protection Essentials",
                                    "description": "The Endpoint Threat Protection Essentials solution provides content to monitor, detect and investigate threats related to windows machines.",
                                    "value": "Endpoint Threat Protection Essentials"
                                },
                                {
                                    "label": "Network Session Essentials",
                                    "description": "The Network Session Essentials solution leverages the Advanced Security Information Model (ASIM) to correlate insights across 15+ networking data sources and deliver more value for SOC use cases with less content.",
                                    "value": "Network Session Essentials"
                                }, 
                                {
                                    "label": "Network Threat Protection Essentials",
                                    "description": "The Network Threat Protection Essentials solution contains queries that identifies suspicious network behavior based on various data sources ingested in Sentinel.",
                                    "value": "Network Threat Protection Essentials"
                                }
                            ],
                            "required": false
                        },
                        "visible": true
                    }
                ]
            },
            {
                "name": "dataConnectors",
                "label": "Data connectors",
                "elements": [
                    {
                        "name": "infoBoxConnectors",
                        "type": "Microsoft.Common.InfoBox",
                        "visible": true,
                        "options": {
                            "icon": "Info",
                            "text": "Please select which Data Connectors you would like to configure in your Microsoft Sentinel environment",
                            "uri": "https://learn.microsoft.com/azure/sentinel/data-connectors-reference"
                        }
                    },
                    {
                        "name": "enableDataConnectors",
                        "type": "Microsoft.Common.DropDown",
                        "label": "Select data connectors to onboard",
                        "placeholder": "",
                        "multiselect": true,
                        "filter": true,
                        "filterPlaceholder": "Filter items ...",
                        "multiLine": true,
                        "defaultDescription": "A value for selection",
                        "toolTip": "Select the data connectors that you would like to enable",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Microsoft Entra ID",
                                    "description": "Relevant license and Global Admin or Security Admin permission required.",
                                    "value": "AzureActiveDirectory"
                                },  
                                {
                                    "label": "Microsoft Entra ID Identity Protection",
                                    "description": "Relevant license and Global Admin or Security Admin permission required.",
                                    "value": "AzureActiveDirectoryIDP"
                                },
                                {
                                    "label": "Azure Activity",
                                    "description": "This will only bring logs from the subscription selected in Basics tab. Relevant permissions at the subscription level are required.",
                                    "value": "AzureActivity"
                                },
                                {
                                    "label": "Microsoft 365 Defender",
                                    "description": "This will only enable incident and alert synchronization, no advanced hunting data will be enabled. Relevant license and Global Admin or Security Admin permission required",
                                    "value": "Microsoft365Defender"
                                },
                                {
                                    "label": "Microsoft Defender for Cloud",
                                    "description": "Security Reader permission required",
                                    "value": "MicrosoftDefenderForCloud"
                                },
                                {
                                    "label": "Office 365",
                                    "description": "Relevant license and Global Admin or Security Admin permission required",
                                    "value": "Office365"
                                },
                                {
                                    "label": "Threat Intelligence Platforms",
                                    "description": "Global Admin or Security Admin permission required",
                                    "value": "ThreatIntelligence"
                                }
                            ],
                            "required": true
                        },
                        "visible": true
                    },
                    {
                        "name": "aadStreams",
                        "type": "Microsoft.Common.DropDown",
                        "label": "Select Microsoft Entra ID log types to enable",
                        "placeholder": "",
                        "multiselect": true,
                        "defaultValue": [{"value": "SignInLogs"}, {"value": "AuditLogs"}],
                        "toolTip": "Select Microsoft Entra ID log types you would like to stream to the workspace",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Signin Logs",
                                    "value": "SignInLogs"
                                },
                                {
                                    "label": "Audit Logs",
                                    "value": "AuditLogs"
                                },
                                {
                                    "label": "Non-Interactive User Sign-In Logs",
                                    "value": "NonInteractiveUserSignInLogs"
                                },
                                {
                                    "label": "Service Principal Sign-In Logs",
                                    "value": "ServicePrincipalSignInLogs"
                                },
                                {
                                    "label": "Managed Identity Sign-In Logs",
                                    "value": "ManagedIdentitySignInLogs"
                                },
                                {
                                    "label": "User Risk Events",
                                    "value": "UserRiskEvents"
                                },
                                {
                                    "label": "Risky Users",
                                    "value": "RiskyUsers"
                                },
                                {
                                    "label": "Risky Service Principals",
                                    "value": "RiskyServicePrincipals"
                                },
                                {
                                    "label": "Service Principal Risk Events",
                                    "value": "ServicePrincipalRiskEvents"
                                }
                            ],
                            "required": false
                        },
                        "visible": "[contains(steps('dataConnectors').enableDataConnectors, 'AzureActiveDirectory')]"
                    }
                ]
            },
            {
                "name": "analyticsRules",
                "label": "Analytics Rules",
                "elements": [
                    {
                        "name": "infoBoxRules",
                        "type": "Microsoft.Common.InfoBox",
                        "visible": true,
                        "options": {
                            "icon": "Info",
                            "text": "Please select which analytics rules you would like to enable in your Microsoft Sentinel environment",
                            "uri": "https://learn.microsoft.com/azure/sentinel/detect-threats-built-in"
                        }
                    },
                    {
                        "name": "enableMLAlerts",
                        "type": "Microsoft.Common.CheckBox",
                        "label": "Enable ML Behavior Analytics alert rules?",
                        "toolTip": "Select to enable ML Behavior Analytics rules for selected connectors (SecurityEvents and/or Syslog)",
                        "constraints": {
                            "required": false,
                            "validationMessage": "Enables SSH and/or RDP anomalous login alerts"
                        },
                        "visible": "[or(contains(steps('dataConnectors').enableDataConnectors,'Syslog'),contains(steps('dataConnectors').enableDataConnectors,'SecurityEvents'))]"
                    },
                   {
                        "name": "enableScheduledAlerts",
                        "type": "Microsoft.Common.CheckBox",
                        "label": "Enable Scheduled alert rules for selected Content Hub solutions and Data Connectors?",
                        "toolTip": "Select to enable Scheduled and NRT analytics rules for the solutions and connectors selected in the previous tabs",
                        "constraints": {
                            "required": false,
                            "validationMessage": "Enables Scheduled and NRT rules matching any of the selected solutions and connectors"
                        },
                        "visible": true
                    },
                    {
                        "name": "severityLevels",
                        "type": "Microsoft.Common.DropDown",
                        "label": "Select the severity of the rules to enable",
                        "placeholder": "",
                        "multiselect": true,
                        "defaultValue": [{"value": "High"}, {"value": "Medium"}],
                        "toolTip": "Select the data connectors that you would like to enable",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "High",
                                    "value": "High"
                                },
                                {
                                    "label": "Medium",
                                    "value": "Medium"
                                },
                                {
                                    "label": "Low",
                                    "value": "Low"
                                },
                                {
                                    "label": "Informational",
                                    "value": "Informational"
                                }
                            ],
                            "required": false
                        },
                        "visible": "[steps('analyticsRules').enableScheduledAlerts]"
                    }
                ]
            }
        ],
        "outputs": {
            "workspaceName": "[basics('workspaceName')]",
            "dailyQuota": "[basics('dailyQuota')]",
            "pricingTier": "[basics('pricingTier')]",
            "capacityReservation": "[basics('capacityReservation')]",
            "standardTierRetention": "[steps('storageConfig').standardTierRetention]",
            "auxiliaryTierRetention": "[steps('storageConfig').auxiliaryTierRetention]",
            "basicTierRetention": "[steps('storageConfig').basicTierRetention]",
            "enableMultiTier": "[steps('storageConfig').enableMultiTier]",
            "enableUeba": "[steps('settings').enableUeba]",
            "identityProviders": "[steps('settings').identityProviders]",
            "enableDiagnostics": "[steps('settings').enableDiagnostics]",
            "enableSolutions1P": "[steps('solutions').enableSolutions1P]",
            "enableSolutionsEssentials": "[steps('solutions').enableSolutionsEssentials]",
            "enableDataConnectors": "[steps('dataConnectors').enableDataConnectors]",
            "aadStreams": "[steps('dataConnectors').aadStreams]",
            "location": "[location()]",
            "enableMLAlerts": "[steps('analyticsRules').enableMLAlerts]",
            "enableScheduledAlerts": "[steps('analyticsRules').enableScheduledAlerts]",
            "severityLevels": "[steps('analyticsRules').severityLevels]",
            "rgName": "[basics('rgName')]",
            "enableCostDashboard": "[steps('costOptimization').enableCostDashboard]",
            "entraIDTier": "[steps('costOptimization').entraIDSection.entraIDTier]",
            "nonInteractiveSignInsEnabled": "[steps('costOptimization').entraIDSection.nonInteractiveSignInsEnabled]",
            "enableCorelight": "[steps('costOptimization').corelightSection.enableCorelight]",
            "highValueTableTier": "[steps('costOptimization').corelightSection.highValueTableTier]",
            "mediumValueTableTier": "[steps('costOptimization').corelightSection.mediumValueTableTier]",
            "lowValueTableTier": "[steps('costOptimization').corelightSection.lowValueTableTier]",
            "industryVertical": "[steps('industrySpecific').industryVertical]"
        }
    }
}
